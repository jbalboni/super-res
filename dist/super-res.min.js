function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("q"),require("route-parser"),require("cache-manager"),require("superagent"),require("methods")):"function"==typeof define&&define.amd?define(["q","route-parser","cache-manager","superagent","methods"],r):e.superRes=r(e.Q,e.Route,e.cacheManager,e.sa,e.methods)}(this,function(e,r,t,n,a){"use strict";function o(){for(var e={},r=arguments.length,t=Array(r),n=0;r>n;n++)t[n]=arguments[n];return t.reduce(function(e,r){if(r)for(var t in r)"object"==typeof r[t]&&null!==r[t]?Array.isArray(r[t])?(Array.isArray(e[t])||(e[t]=[]),e[t]=e[t].concat(r[t])):(("object"!=typeof e[t]||null===e[t]||Array.isArray(e[t]))&&(e[t]={}),s(e[t],r[t])):void 0!==r[t]&&(e[t]=r[t]);return e},e),e}function u(r,t,a){a=o(f,a);var u=n(r,t);u.accept(a.responseType),a.headers&&u.set(a.headers),a.timeout?u.timeout(a.timeout):u.clearTimeout(),a.withCredentials&&u.withCredentials();var c=u.end;return u.end=function(r){if(u._data&&"object"==typeof u._data)try{u._data=a.transformRequest.reduce(function(e,r){return r.call(u,e,u.header)},u._data)}catch(t){return a.catchRequestError.reduce(function(e,r){return e["catch"](r)},e.Promise(function(e,r){return r(t)})).then(r,r),this}return c.call(u,function(t,n){if(!t){try{n.body=a.transformResponse.reduce(function(e,r){return r.call(n,e)},n.body)}catch(o){return e(o).then(r)}return e.spread([null,n],r)}a.catchResponseError.reduce(function(e,r){return e["catch"](r)},e.Promise(function(e,r){return r(t)})).then(r,r)})},u}function c(e,r){return e&&this.query(e),null}function i(e,r,t){var n={},a=new d(e,r,m({},t));return n.get=a.makeRequest.bind(a),n.query=n.get,a=new d(e,r,m({},t,{method:"POST"})),n.save=a.makeRequest.bind(a),a=new d(e,r,m({},t,{method:"PUT"})),n.put=a.makeRequest.bind(a),a=new d(e,r,m({},t,{method:"DELETE"})),n.remove=a.makeRequest.bind(a),n["delete"]=n.remove,n}var s=s||require("object.assign"),f={responseType:"json",transformRequest:[],catchRequestError:[],transformResponse:[],catchResponseError:[],withCredentials:!1,cache:null};a.forEach(function(e){var r="delete"==e?"del":e;e=e.toUpperCase(),Object.defineProperty(u,r,{value:function(r,t,n,a){"function"==typeof t&&(a=n,n=t,t=null);var o=u(e,r,a);return t&&o.send(t),n&&o.end(n),o},enumerable:!0})}),Object.defineProperty(u,"config",{value:f});var h=h||require("object.assign"),l={method:"GET",transformRequest:[],cache:null},d=function(){function n(e,a,u){_classCallCheck(this,n),this.config=o({url:e},l,u),"GET"===this.config.method&&(this.config.transformRequest||(this.config.transformRequest=[]),this.config.transformRequest.push(c)),this.route=new r(this.config.url),this.defaultParams=a,this.config.cache===!0&&(this.config.cache=t.caching({store:"memory",max:100,ttl:1200}))}return _createClass(n,[{key:"getCacheKey",value:function(e,r){return this.route.reverse(e)+JSON.stringify(r)}},{key:"buildRequest",value:function(e,r){var t=this.config.method.toLowerCase(),n=this.route.reverse(e);for(var a in this.route.match(n))delete e[a];var o=!0;if(e)for(var a in e){o=!1;break}var c=u["delete"===t?"del":t](n,null,null,this.config);return o||c.query(e),r&&c.send(r),c}},{key:"makeRequest",value:function(r,t){var n=this,a=e.defer(),o=h({},this.defaultParams,r),u=function(){n.buildRequest(o,t).end(function(e,r){e?a.reject(e):(n.config.cache&&n.config.cache.set(n.getCacheKey(o,t),r.body),a.resolve(r.body))})};if(this.config.cache&&"get"===this.config.method.toLowerCase()){var c=this.getCacheKey(o,t);this.config.cache.get(c,function(e,r){e?a.reject(e):r?a.resolve(r):u()})}else u();return a.promise}}]),n}(),m=m||require("object.assign"),g={};g.resource=function(e,r,t,n){var a=i(e,r,n);return t&&Object.getOwnPropertyNames(t).forEach(function(n){var o=new d(e,r,t[n]);a[n]=function(){o.makeRequest.apply(o,arguments)}}),a},g.request=u,g.config=u.config,g.promiseWrapper=function(e){return function(r){var t=m({},r);return Object.getOwnPropertyNames(r).forEach(function(r){var n=t[r];t[r]=function(){for(var r=arguments.length,a=Array(r),o=0;r>o;o++)a[o]=arguments[o];var u=n.apply(t,a);return e(u)}}),t}};var p=g;return p});
//# sourceMappingURL=super-res.min.js.map