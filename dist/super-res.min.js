!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("q"),require("superagent"),require("route-parser"),require("cache-manager")):"function"==typeof define&&define.amd?define(["q","superagent","route-parser","cache-manager"],r):e.superRes=r(e.Q,e.superagent,e.Route,e.cacheManager)}(this,function(e,r,t,n){"use strict";function u(r){return function(t){return e.resolve(r.reduce(function(e,r){return r(e,t.header)},t.body))}}function o(e,r,t){return e.reduce(function(e,t){return t(e,r)},t)}function a(e){var r=e.toUpperCase();return"POST"===r||"PUT"===r||"PATCH"===r}function s(e){return Object.getOwnPropertyNames(e).reduce(function(r,t){var n=e[t];return"function"==typeof n?r.derivedParams[t]=n:"string"==typeof n&&n.startsWith("@")?r.derivedParams[t]=n.slice(1):r.defaultParams[t]=n,r},{derivedParams:{},defaultParams:{}})}function c(e){return function(r,t){return e.reverse(r)+JSON.stringify(t||{})}}function i(r,t,n){var u=e.defer();return t&&"GET"===r.toUpperCase()?t.get(n,function(e,r){e?u.reject(e):u.resolve(r?{found:!0,result:r}:{found:!1})}):u.resolve({found:!1}),u.promise}function f(e,r,t){return Object.getOwnPropertyNames(e).reduce(function(r,n){var u=e[n];return r[n]="function"==typeof u?u():t[u],r},y({},r))}function d(e,r){return function(t){return r?o(e,t,r):null}}function m(r,o,m){var p=y({url:r},v,m),h=new t(p.url),q=s(o||{}),P=q.derivedParams,O=q.defaultParams,T=u(p.transformResponse),j=c(h);return p.cache=p.cache===!0?n.caching(g):p.cache,function(r,t){1===arguments.length&&a(p.method)&&(t=r,r=void 0);var n=y(f(P,O,t),r),u=h.reverse(n),o=l.configureRequest(p,u,d(p.transformRequest,t)),s=j(n,t);return i(p.method,p.cache,s).then(function(r){var t=r.found,n=r.result;return t?e.resolve(n):l.makeRequest(o).then(T).then(function(r){return p.cache&&p.cache.set(s,r),e.resolve(r)})})}}function p(e,r){var t={};return t.get=m(e,r),t.query=t.get,t.save=m(e,r,{method:"POST"}),t.put=m(e,r,{method:"PUT"}),t.remove=m(e,r,{method:"DELETE"}),t["delete"]=t.remove,t}var h={};h.configureRequest=function(e,t,n){var u=e.method.toLowerCase(),o=r["delete"===u?"del":u](t);e.plugins&&e.plugins.length&&e.plugins.forEach(function(e){o=o.use(e)}),o=o.accept(e.responseType),e.headers&&(o=o.set(e.headers)),e.timeout?o.timeout(e.timeout):o.clearTimeout(),e.withCredentials&&(o=o.withCredentials());var a=n(o.header);return a&&(o="get"===u?o.query(a):o.send(a)),o},h.makeRequest=function(r){var t=e.defer();return r.end(function(e,r){e?t.reject(e):t.resolve(r)}),t.promise};var l=h,v=v={method:"GET",responseType:"json",transformRequest:[],transformResponse:[],withCredentials:!1,cache:null,plugins:[]},g={store:"memory",max:100,ttl:1200},y=y||require("object.assign"),q=q||require("object.assign"),P={};P.resource=function(e,r,t){var n=p(e,r);return t&&Object.getOwnPropertyNames(t).forEach(function(u){n[u]=m(e,r,t[u])}),n},P.promiseWrapper=function(e){return function(r){var t=q({},r);return Object.getOwnPropertyNames(r).forEach(function(r){var n=t[r];t[r]=function(){for(var r=arguments.length,u=Array(r),o=0;r>o;o++)u[o]=arguments[o];var a=n.apply(t,u);return e(a)}}),t}};var O=P;return O});
//# sourceMappingURL=super-res.min.js.map