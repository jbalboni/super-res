function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("q"),require("route-parser"),require("cache-manager"),require("superagent"),require("methods")):"function"==typeof define&&define.amd?define(["q","route-parser","cache-manager","superagent","methods"],t):e.superRes=t(e.Q,e.Route,e.cacheManager,e.sa,e.methods)}(this,function(e,t,r,n,a){"use strict";function o(){for(var e={},t=arguments.length,r=Array(t),n=0;t>n;n++)r[n]=arguments[n];return r.reduce(function(e,t){if(t)for(var r in t)"object"==typeof t[r]&&null!==t[r]?Array.isArray(t[r])?(Array.isArray(e[r])||(e[r]=[]),e[r]=e[r].concat(t[r])):(("object"!=typeof e[r]||null===e[r]||Array.isArray(e[r]))&&(e[r]={}),f(e[r],t[r])):void 0!==t[r]&&(e[r]=t[r]);return e},e),e}function i(t,r,a){a=o(h,a);var i=n(t,r);i.accept(a.responseType),a.headers&&i.set(a.headers),a.timeout?i.timeout(a.timeout):i.clearTimeout(),a.withCredentials&&i.withCredentials();var s=i.end;return i.end=function(t){if(i._data&&"object"==typeof i._data)try{i._data=a.transformRequest.reduce(function(e,t){return t.call(i,e,i.header)},i._data)}catch(r){return a.catchRequestError.reduce(function(e,t){return e["catch"](t)},e.Promise(function(e,t){return t(r)})).then(t,t),this}return s.call(i,function(r,n){if(!r){try{n.body=a.transformResponse.reduce(function(e,t){return t.call(n,e)},n.body)}catch(o){return e(o).then(t)}return e.spread([null,n],t)}a.catchResponseError.reduce(function(e,t){return e["catch"](t)},e.Promise(function(e,t){return t(r)})).then(t,t)})},i}function s(e,t){return e&&this.query(e),null}function u(e,t){return JSON.stringify(e||{})+JSON.stringify(t||{})}function c(e,t,r){var n={},a=new m(e,t,g({},r));return n.get=a.makeRequest.bind(a),n.query=n.get,a=new m(e,t,g({},r,{method:"POST"})),n.save=a.makeRequest.bind(a),a=new m(e,t,g({},r,{method:"PUT"})),n.put=a.makeRequest.bind(a),a=new m(e,t,g({},r,{method:"DELETE"})),n.remove=a.makeRequest.bind(a),n["delete"]=n.remove,n}var f=f||require("object.assign"),h={responseType:"json",transformRequest:[],catchRequestError:[],transformResponse:[],catchResponseError:[],withCredentials:!1,cache:null};a.forEach(function(e){var t="delete"==e?"del":e;e=e.toUpperCase(),Object.defineProperty(i,t,{value:function(t,r,n,a){"function"==typeof r&&(a=n,n=r,r=null);var o=i(e,t,a);return r&&o.send(r),n&&o.end(n),o},enumerable:!0})}),Object.defineProperty(i,"config",{value:h});var l=l||require("object.assign"),d={method:"GET",transformRequest:[],cache:null},m=function(){function n(e,a,i){_classCallCheck(this,n),this.config=o({url:e},d,i),"GET"===this.config.method?(this.config.transformRequest||(this.config.transformRequest=[]),this.config.transformRequest.push(s)):("POST"===this.config.method||"PUT"===this.config.method||"PATCH"===this.config.method)&&(this.hasData=!0),this.route=new t(this.config.url),this.defaultParams=a,this.extraParams={};for(var u in a){var c=a[u];if("function"==typeof c)this.extraParams[u]=c;else{if("string"!=typeof c||"@"!==c[0])continue;this.extraParams[u]=c.slice(1)}delete this.defaultParams[u]}this.config.cache===!0&&(this.config.cache=r.caching({store:"memory",max:100,ttl:1200}))}return _createClass(n,[{key:"buildRequest",value:function(e,t){var r=this.config.method.toLowerCase(),n=this.route.reverse(e);for(var a in this.route.match(n))delete e[a];var o=!0;if(e)for(var a in e){o=!1;break}var s=i["delete"===r?"del":r](n,null,null,this.config);return o||s.query(e),t&&s.send(t),s}},{key:"makeRequest",value:function(t,r){var n=this,a=e.defer();1==arguments.length&&this.hasData&&(r=t,t=void 0);var o={};for(var i in this.extraParams){var s=this.extraParams[i],c=void 0;c="function"==typeof s?s():r[s],c&&(o[i]=c)}var f=l({},this.defaultParams,o,t),h=function(){n.buildRequest(f,r).end(function(e,t){e?a.reject(e):(n.config.cache&&n.config.cache.set(u(f,r),t.body),a.resolve(t.body))})};if(this.config.cache&&"get"===this.config.method.toLowerCase()){var d=u(f,r);this.config.cache.get(d,function(e,t){e?a.reject(e):t?a.resolve(t):h()})}else h();return a.promise}}]),n}(),g=g||require("object.assign"),p={};p.resource=function(e,t,r,n){var a=c(e,t,n);return r&&Object.getOwnPropertyNames(r).forEach(function(n){var o=new m(e,t,r[n]);a[n]=function(){o.makeRequest.apply(o,arguments)}}),a},p.request=i,p.config=i.config,p.promiseWrapper=function(e){return function(t){var r=g({},t);return Object.getOwnPropertyNames(t).forEach(function(t){var n=r[t];r[t]=function(){for(var t=arguments.length,a=Array(t),o=0;t>o;o++)a[o]=arguments[o];var i=n.apply(r,a);return e(i)}}),r}};var v=p;return v});
//# sourceMappingURL=super-res.min.js.map